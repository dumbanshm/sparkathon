Loading data files...
Data loaded successfully!
- Users: 200 records
- Products: 300 records
- Transactions: 1000 records
==================================================
UNIFIED WASTE REDUCTION SYSTEM
==================================================

==================================================
DATA ANALYSIS
==================================================

User Demographics:
- Total users: 200
- Diet types: {'vegetarian': 62, 'non-vegetarian': 58, 'vegan': 47, 'eggs': 33}

Product Categories:
category
Biscuits     45
Snacks       41
Spreads      40
Dairy        39
Beverages    39
Cheese       37
Sauces       33
Meat         26
Name: count, dtype: int64

Expiry Status:
- Expired products: 27
- Expiring in 7 days: 9
- Expiring in 30 days: 55

Transaction Summary:
- Total transactions: 1000
- Unique users who made purchases: 175
- Average discount given: 21.18%
- Deal engagement rate: 72.10%

Initializing Unified Recommendation System...
Building content similarity matrix...
Building collaborative filtering model...

==================================================
DEAD STOCK RISK ANALYSIS
==================================================

Total products at risk: 63 (21.0%)

Risk by Category:
- Beverages: 10/39 (25.6%)
- Biscuits: 10/45 (22.2%)
- Cheese: 6/37 (16.2%)
- Dairy: 4/39 (10.3%)
- Meat: 9/26 (34.6%)
- Sauces: 6/33 (18.2%)
- Snacks: 9/41 (22.0%)
- Spreads: 9/40 (22.5%)

Top 10 Products at Risk (with lowest days until expiry):
- Color Beverages (Beverages): -33 days left, threshold: 14 days, current discount: 30%
- Good Biscuits (Biscuits): -33 days left, threshold: 14 days, current discount: 10%
- Face Spreads (Spreads): -29 days left, threshold: 16 days, current discount: 10%
- Seek Meat (Meat): -26 days left, threshold: 15 days, current discount: 20%
- Cause Snacks (Snacks): -23 days left, threshold: 15 days, current discount: 50%
- Oil Cheese (Cheese): -18 days left, threshold: 19 days, current discount: 0%
- Lose Dairy (Dairy): -15 days left, threshold: 13 days, current discount: 20%
- Science Meat (Meat): -14 days left, threshold: 18 days, current discount: 40%
- Break Beverages (Beverages): -14 days left, threshold: 18 days, current discount: 20%
- Operation Snacks (Snacks): -13 days left, threshold: 16 days, current discount: 10%

==================================================
RECOMMENDATION DEMONSTRATIONS
==================================================

==============================
Recommendations for User: U0038
Diet: non-vegetarian, Allergies: []
==============================

1. HYBRID RECOMMENDATIONS (Best Overall):
   - Information Spreads (Spreads)
     Score: 0.744, Days until expiry: 19, Price: ₹307.53, Discount: 50%
   - Fight Meat (Meat)
     Score: 0.490, Days until expiry: 73, Price: ₹331.2, Discount: 20%
   - Similar Meat (Meat)
     Score: 0.448, Days until expiry: 13, Price: ₹300.09, Discount: 50%
     ⚠️  AT RISK OF BECOMING DEAD STOCK
   - Step Snacks (Snacks)
     Score: 0.362, Days until expiry: 107, Price: ₹417.82, Discount: 10%
   - White Meat (Meat)
     Score: 0.355, Days until expiry: 134, Price: ₹493.78, Discount: 20%

2. CONTENT-BASED RECOMMENDATIONS (Similar to your purchases):
   Based on your purchase of: One Spreads
   - Guess Spreads (Spreads)
     Similarity: 0.851, Days until expiry: 103
   - Sign Sauces (Sauces)
     Similarity: 0.764, Days until expiry: 113
   - Include Sauces (Sauces)
     Similarity: 0.711, Days until expiry: 95

==============================
Recommendations for User: U0010
Diet: vegetarian, Allergies: []
==============================

1. HYBRID RECOMMENDATIONS (Best Overall):
   - Pass Biscuits (Biscuits)
     Score: 0.560, Days until expiry: 111, Price: ₹75.2, Discount: 20%
   - Information Spreads (Spreads)
     Score: 0.461, Days until expiry: 19, Price: ₹307.53, Discount: 50%
   - Baby Spreads (Spreads)
     Score: 0.385, Days until expiry: 13, Price: ₹325.75, Discount: 10%
     ⚠️  AT RISK OF BECOMING DEAD STOCK
   - Represent Dairy (Dairy)
     Score: 0.368, Days until expiry: 91, Price: ₹92.61, Discount: 30%
   - Fast Snacks (Snacks)
     Score: 0.297, Days until expiry: 51, Price: ₹471.14, Discount: 30%

2. CONTENT-BASED RECOMMENDATIONS (Similar to your purchases):
   Based on your purchase of: Chance Dairy
   - Model Beverages (Beverages)
     Similarity: 0.628, Days until expiry: 129
   - Represent Dairy (Dairy)
     Similarity: 0.613, Days until expiry: 91
   - Pass Biscuits (Biscuits)
     Similarity: 0.602, Days until expiry: 111

==============================
Recommendations for User: U0185
Diet: vegetarian, Allergies: ['dairy']
==============================

1. HYBRID RECOMMENDATIONS (Best Overall):
   - Behavior Sauces (Sauces)
     Score: 15.270, Days until expiry: 13, Price: ₹279.71, Discount: 0%
     ⚠️  AT RISK OF BECOMING DEAD STOCK
   - Moment Spreads (Spreads)
     Score: 12.610, Days until expiry: 19, Price: ₹466.59, Discount: 30%
     ⚠️  AT RISK OF BECOMING DEAD STOCK
   - Tend Dairy (Dairy)
     Score: 11.350, Days until expiry: 5, Price: ₹443.26, Discount: 0%
     ⚠️  AT RISK OF BECOMING DEAD STOCK
   - Job Spreads (Spreads)
     Score: 11.010, Days until expiry: 29, Price: ₹70.67, Discount: 0%
   - Information Spreads (Spreads)
     Score: 10.410, Days until expiry: 19, Price: ₹307.53, Discount: 50%

==================================================
WASTE REDUCTION STRATEGIES
==================================================

1. URGENT ACTION REQUIRED (9 products):

   Product: Single Biscuits
   - Days until expiry: 1
   - Current discount: 10%
   - Suggested discount: 30%
   - Dynamic threshold: 15 days

   Product: Include Spreads
   - Days until expiry: 1
   - Current discount: 50%
   - Suggested discount: 50%
   - Dynamic threshold: 18 days

   Product: Century Beverages
   - Days until expiry: 2
   - Current discount: 50%
   - Suggested discount: 50%
   - Dynamic threshold: 12 days

   Product: Doctor Biscuits
   - Days until expiry: 5
   - Current discount: 30%
   - Suggested discount: 50%
   - Dynamic threshold: 15 days

   Product: Tend Dairy
   - Days until expiry: 5
   - Current discount: 0%
   - Suggested discount: 20%
   - Dynamic threshold: 26 days

2. CATEGORY-WISE OPTIMIZATION:

   Biscuits:
   - Base threshold: 14 days
   - Products at risk: 10/45
   - Avg days to expiry for at-risk: 0.7

   Beverages:
   - Base threshold: 19 days
   - Products at risk: 10/39
   - Avg days to expiry for at-risk: -1.4

   Snacks:
   - Base threshold: 19 days
   - Products at risk: 9/41
   - Avg days to expiry for at-risk: -3.4

   Sauces:
   - Base threshold: 22 days
   - Products at risk: 6/33
   - Avg days to expiry for at-risk: 21.2

   Spreads:
   - Base threshold: 22 days
   - Products at risk: 9/40
   - Avg days to expiry for at-risk: 7.2

   Cheese:
   - Base threshold: 23 days
   - Products at risk: 6/37
   - Avg days to expiry for at-risk: -0.5

   Dairy:
   - Base threshold: 23 days
   - Products at risk: 4/39
   - Avg days to expiry for at-risk: 4.2

   Meat:
   - Base threshold: 26 days
   - Products at risk: 9/26
   - Avg days to expiry for at-risk: 2.0

==================================================
COMPREHENSIVE RECOMMENDATION TESTING
==================================================

Testing recommendations for all 200 users...
--------------------------------------------------
Processed 50/200 users...
Processed 100/200 users...
Processed 150/200 users...
Processed 200/200 users...

==================================================
TESTING RESULTS SUMMARY
==================================================

Overall Statistics:
- Total users tested: 200
- Successful recommendations: 200 (100.0%)
- Users with issues: 0 (0.0%)

Issue Breakdown:

1. Users with NO PURCHASE HISTORY: 25
   Diet type distribution:
   - vegan: 11
   - vegetarian: 9
   - non-vegetarian: 3
   - eggs: 2

4. Users getting mostly EXPIRED/EXPIRING products: 1
   - User U0066: Avg days to expiry = 6.6

==================================================
SPECIFIC CORNER CASE TESTING
==================================================

1. Testing user with multiple allergies:

2. Testing vegan users:
   - 47/47 vegan users got recommendations

3. Dead stock recommendation distribution:
   - 29/100 (29.0%) recommendations are dead stock risk items

==================================================
SYSTEM READY FOR USE
==================================================

The unified waste reduction system is now initialized and ready.
You can use the 'system' object to generate recommendations for any user.

Example usage:
  recommendations = system.get_hybrid_recommendations('U0001', n_recommendations=10)
